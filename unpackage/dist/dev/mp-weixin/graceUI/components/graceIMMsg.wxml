<view class="grace-im" bind:__l="__l"><scroll-view style="{{'height:'+(imHeight+'px')+';'}}" scroll-y scroll-top="{{scrollTop}}"><view style="height:10px;"></view><view class="grace-im-msg"><view data-event-opts="{{[['tap',[['getHistoryMsg',['$event']]]]]}}" class="grace-im-system-msg" bindtap="__e">{{historyLodginText}}</view></view><block wx:for="{{msgs}}" wx:for-item="item" wx:for-index="index" wx:key="index"><block><block wx:if="{{item.ctype==1}}"><view class="{{['grace-im-msg',userid==item.id?'grace-im-msg-right':'grace-im-msg-left']}}"><view class="face"><image src="{{item.face}}" mode="widthFix"></image></view><view><view class="grace-im-name"><block wx:if="{{userid!=item.id}}"><text>{{item.name}}</text></block><text>{{item.date}}</text></view><view class="grace-im-content-in"><view class="content">{{item.msg}}</view></view></view></view></block><block wx:if="{{item.ctype==2}}"><view class="{{['grace-im-msg',userid==item.id?'grace-im-msg-right':'grace-im-msg-left']}}"><view class="face"><image src="{{item.face}}" mode="widthFix"></image></view><view><view class="grace-im-name"><block wx:if="{{userid!=item.id}}"><block>{{item.name}}</block></block><text>{{item.date}}</text></view><view class="grace-im-content-in"><view class="imgs"><image src="{{item.msg}}" mode="widthFix" data-index="{{index}}" data-event-opts="{{[['tap',[['showImgs',['$event']]]]]}}" bindtap="__e"></image></view></view></view></view></block><block wx:if="{{item.ctype==3}}"><view class="{{['grace-im-msg',userid==item.id?'grace-im-msg-right':'grace-im-msg-left']}}"><view class="face"><image src="{{item.face}}" mode="widthFix"></image></view><view><view class="grace-im-name"><block wx:if="{{userid!=item.id}}"><block>{{item.name}}</block></block><text>{{item.date}}</text></view><view class="grace-im-content-in"><view class="{{['content grace-im-voice-msg',index==playIndex?'grace-im-playing':'']}}" style="width:300rpx;" data-voice="{{item.msg}}" data-index="{{index}}" data-event-opts="{{[['tap',[['playVoice',['$event']]]]]}}" bindtap="__e"><text class="graceIMFont icon-audio"></text></view></view></view></view></block><block wx:if="{{item.ctype==4}}"><view class="grace-im-msg"><view class="grace-im-system-msg">{{item.msg}}</view></view></block></block></block><view style="height:20px;"></view></scroll-view></view>